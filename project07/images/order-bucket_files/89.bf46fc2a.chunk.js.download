(this["webpackJsonpreusable-comps"]=this["webpackJsonpreusable-comps"]||[]).push([[89],{1074:function(e,t,l){"use strict";l.r(t);var a=l(3),c=l.n(a),n=l(1303),s=l(1278),i=l(32),r=l(4),o=l(5),d=l(28),j=l(2);var b=e=>{const t=Object(d.c)((e=>e.appStateReducer.userStatus)),l=null===t||void 0===t?void 0:t.loggedIn,{LOGGED_IN_MSG:b}=r.a,{tenantReducer:u}=Object(d.c)((e=>e));return Object(a.useEffect)((()=>{((e,t)=>{var l;const a=null===t||void 0===t||null===(l=t.deeplink)||void 0===l?void 0:l.pontaRedirectUri;if(null!==o.Id&&void 0!==o.Id&&Object(o.Id)(null===e||void 0===e?void 0:e.location)&&a){var c,n,s;const t=null===(c=new URLSearchParams(e.location.search))||void 0===c?void 0:c.get("w"),l=null===(n=new URLSearchParams(e.location.search))||void 0===n?void 0:n.get("e"),i=t?"?w=".concat(t):"?e=".concat(l);null===e||void 0===e||null===(s=e.location)||void 0===s||s.assign("".concat(a).concat(i))}})(window,u)}),[]),Object(j.jsx)(c.a.Fragment,{children:l?Object(j.jsx)(n.a,{}):Object(j.jsx)(s.a,{success:!1,msg:Object(i.translateWithI18Next)(b),infinit:!0})})};t.default=b},1145:function(e,t,l){"use strict";l.d(t,"d",(function(){return a})),l.d(t,"a",(function(){return c})),l.d(t,"c",(function(){return n})),l.d(t,"b",(function(){return s}));const a={HOME:"Home",CARD_DETAILS_VIEW:"Card Details View",KFC_FORM:"KFC form",MILE_DETAILS:"mile details",RANKING:"Ranking"},c={KFC:"kfc",PONTA:"ponta",RAKUTEN:"rakuten"},n={PLATINUM:"platinum",REGULAR:"regular",BRONZE:"bronze",SILVER:"silver",GOLD:"gold"},s={milesMemberId:"I",stageNumber:"R",pontaId:"P",kfcCard:"K",rakutenId:"RK",expirationTime:"ED"}},1235:function(e,t,l){"use strict";var a=l(3),c=l.n(a),n=l(32),s=l(4),i=l(106),r=l(92),o=l(15),d=l(2);t.a=e=>{let{confirmationMsg:t,handleClose:l,handleConfirmBtn:a,imageSrc:j}=e;const{CONFIRM_BTN_TEXT:b,CANCEL:u}=s.a;return Object(d.jsx)(c.a.Fragment,{children:Object(d.jsx)(i.a,{handleClose:l,classNames:"delete-account-modal unlink-confirmation-modal",CartAlertForm:Object(d.jsx)(r.a,{title:t,cancelButtonText:Object(n.translateWithI18Next)(u),confirmButtonText:Object(n.translateWithI18Next)(b),confirmHandler:a,cancelHandler:l,imageSrc:o.a.PictogramAlertIcon})})})}},1263:function(e,t,l){"use strict";var a=l(3),c=l.n(a),n=l(28),s=l(14),i=l(11),r=l(51),o=l(1235),d=l(6),j=l(4),b=l(1145),u=l(15),O=l(2);t.a=e=>{let{setStep:t,cardType:l,setShowConfirmationModal:v,handleUnlinkedAction:m,showConfirmationModal:h}=e;const x=Object(n.b)(),[N,g]=Object(a.useState)(!1),{ID:I,UNLINK:y,EXPIRATION_DATE:p,BALANCE:A,UNLINK_CONFIRMATION_MESSAGE:f,ABOUT_KFC_CARD:k,TRANSFER_BALANCE:_,AVAILABLE_POINTS:C,PONTA_CARD_NUMBER:T,RAKUTEN_CARD_NUMBER:E,LINKING:R}=j.a,M=l===b.a.KFC,S=Object(n.c)((e=>{var t;return null===e||void 0===e||null===(t=e.loyaltyMileageReducer)||void 0===t?void 0:t.userMiles})),{KFC_Card:L,PontaId:D,RakutenId:w}=S||{},W=Object(n.c)((e=>{var t,l;return null===e||void 0===e||null===(t=e.loyaltyMileageReducer)||void 0===t||null===(l=t.rakutenBalanceInquiry)||void 0===l?void 0:l.AvailablePoints})),K=Object(n.c)((e=>{var t,l;return null===e||void 0===e||null===(t=e.loyaltyMileageReducer)||void 0===t||null===(l=t.pontaBalanceInquiry)||void 0===l?void 0:l.AvailablePoints})),P="-1"===(null===S||void 0===S?void 0:S.RakutenId),U=Object(n.c)((e=>{var t;return null===e||void 0===e||null===(t=e.tenantReducer)||void 0===t?void 0:t.hideRakutenIdInDetails})),F=Object(n.c)((e=>{var t;return null===e||void 0===e||null===(t=e.loyaltyMileageReducer)||void 0===t?void 0:t.kfcLinkingData})),{BalanceAfter:B,ExpirationDate:H}=F||{};let G="";if(H){const e=H.slice(0,4),t=H.slice(4,6),l=H.slice(6,8);G="".concat(e,"/").concat(t,"/").concat(l)}return Object(a.useEffect)((()=>{x(Object(r.j)({memberId:w}))}),[w]),Object(a.useEffect)((()=>{x(Object(r.i)({memberId:D}))}),[D]),Object(O.jsx)("div",{className:"kfc-card-details align-items-center flex-column d-flex",children:Object(O.jsxs)("div",{className:"col-12 col-lg-8 p-0",children:[h&&Object(O.jsx)(o.a,{confirmationMsg:Object(d.translateWithI18Next)(f),handleClose:()=>v(!1),handleConfirmBtn:()=>m(l),imageSrc:u.a.PictogramAlertIcon}),Object(O.jsx)("button",{onClick:()=>t(b.d.Home),className:"btn-back",children:"\u2794"}),Object(O.jsxs)("div",{className:"kfc-card-details_wrapper",children:[M&&Object(O.jsxs)(c.a.Fragment,{children:[Object(O.jsxs)("div",{className:"info-wraper",children:[Object(O.jsx)("p",{className:"lbl-note-dark",children:Object(d.translateWithI18Next)(A)}),Object(O.jsx)("p",{className:"detail-value",children:B})]}),Object(O.jsxs)("div",{className:"info-wraper",children:[Object(O.jsx)("p",{className:"lbl-note-dark",children:Object(d.translateWithI18Next)(I)}),Object(O.jsx)("p",{className:"detail-value",children:L})]}),Object(O.jsxs)("div",{className:"info-wraper",children:[Object(O.jsx)("p",{className:"lbl-note-dark",children:Object(d.translateWithI18Next)(p)}),Object(O.jsx)("p",{className:"detail-value",children:G})]}),Object(O.jsx)("div",{className:"linking-wraper",children:Object(O.jsx)("a",{href:Object(s.a)(i.mb),target:"_blank",className:"linking-text",rel:"noopener noreferrer",children:Object(d.translateWithI18Next)(_)})})]}),l===b.a.PONTA&&Object(O.jsxs)(c.a.Fragment,{children:[Object(O.jsxs)("div",{className:"info-wraper",children:[Object(O.jsx)("p",{className:"lbl-note-dark",children:Object(d.translateWithI18Next)(C)}),Object(O.jsx)("p",{className:"detail-value",children:K||Object(O.jsx)("div",{className:"loader"})})]}),Object(O.jsxs)("div",{className:"info-wraper",children:[Object(O.jsx)("p",{className:"lbl-note-dark",children:Object(d.translateWithI18Next)(T)}),Object(O.jsx)("p",{className:"detail-value",children:D.slice(-15)})]})]}),l===b.a.RAKUTEN&&Object(O.jsxs)(c.a.Fragment,{children:[!P&&Object(O.jsxs)("div",{className:"info-wraper",children:[Object(O.jsx)("p",{className:"lbl-note-dark",children:Object(d.translateWithI18Next)(C)}),Object(O.jsx)("p",{className:"detail-value",children:W||Object(O.jsx)("div",{className:"loader"})})]}),!U&&Object(O.jsxs)("div",{className:"info-wraper",children:[Object(O.jsx)("p",{className:"lbl-note-dark",children:Object(d.translateWithI18Next)(E)}),Object(O.jsx)("p",{className:"detail-value",children:w})]})]})]}),Object(O.jsx)("div",{className:"loyalty-fields loyalty-fields-btns",children:Object(O.jsx)("button",{"data-loading":N,"data-type":"primary",className:"button-contained kfc-button kfc-unlink-btn ".concat(N?"loading":""),onClick:()=>{x(Object(r.b)()),g(!0),v(!0)},children:Object(d.translateWithI18Next)(y)})}),M&&Object(O.jsx)("p",{style:{textAlign:"center",textDecoration:"underline"},children:Object(O.jsx)("a",{className:"btn-kfc-card btn-link btn-sm",href:"".concat(Object(s.a)(i.a)),children:"".concat(Object(d.translateWithI18Next)(k))})})]})})}},1278:function(e,t,l){"use strict";var a=l(3),c=l(15),n=l(264),s=l(51),i=l(93),r=l(28),o=l(1364),d=l(1365),j=l(6),b=l(2);t.a=e=>{let{success:t,msg:l,infinit:u=!1}=e;const{Error_Yellow:O,GreenCheck:v}=c.a,[m,h]=Object(a.useState)(!0),x=Object(r.b)();Object(a.useEffect)((()=>{if(!u){const e=setTimeout((()=>{h(!1)}),5e3);return m?()=>{x(Object(s.g)({})),clearTimeout(e)}:(x(Object(s.g)({})),null)}}),[x,u,m]);const N=Object(j.translateWithI18Next)(i.a.mapMessageInJP(l));return Object(b.jsx)(o.a,{className:"info-notification_wrapper",children:Object(b.jsxs)(d.a,{xs:"12",className:"info-notification_container ".concat(t&&"greenbg"),children:[Object(b.jsx)("div",{className:"info-notification_icon ",children:t?Object(b.jsx)(n.a,{src:v,className:"info-notification_image green-icon",alt:""}):Object(b.jsx)(n.a,{src:O,className:"info-notification_image",alt:""})}),Object(b.jsx)("div",{className:"info-notification_text-container",children:Object(b.jsx)("div",{className:"info-notification_text",children:N||l})})]})})}},1303:function(e,t,l){"use strict";var a=l(3),c=l.n(a),n=l(1317),s=l.n(n),i=l(441),r=l(2);var o=e=>{let{timer:t,setTimer:l,restartTimer:c,setRestartTimer:n}=e;const s=Object(a.useRef)(null),i=Object(a.useCallback)((e=>{const t=e=>{let{total:t,minutes:a,seconds:c}=(e=>{const t=Date.parse(e)-Date.parse(new Date),l=Math.floor(t/1e3%60);return{total:t,minutes:Math.floor(t/1e3/60%60),seconds:l}})(e);t>=0&&l((a>9?a:"0"+a)+":"+(c>9?c:"0"+c))};l("15:00"),s.current&&clearInterval(s.current);const a=setInterval((()=>{t(e)}),1e3);s.current=a}),[l]),o=()=>{let e=new Date;return e.setSeconds(e.getSeconds()+900),e};return Object(a.useEffect)((()=>{i(o())}),[i]),Object(a.useEffect)((()=>{c&&(i(o()),n(!1))}),[i,c,n]),Object(r.jsx)("div",{className:"",children:Object(r.jsx)("span",{children:t})})},d=l(28),j=l(177),b=l.n(j),u=l(51),O=l(1145),v=l(11),m=l(14),h=l(193);const x=e=>{var t,l,n;const[j,x]=Object(a.useState)(!1),[N,g]=Object(a.useState)(""),[I,y]=Object(a.useState)(!1),p=Object(d.c)((e=>{var t;return null===e||void 0===e||null===(t=e.loyaltyMileageReducer)||void 0===t?void 0:t.userMiles})),A=Object(d.c)((e=>{var t;return null===e||void 0===e||null===(t=e.loyaltyMileageReducer)||void 0===t?void 0:t.pickedData})),f=Object(d.b)(),[k,_]=Object(a.useState)("00:00");let C;switch(null===A||void 0===A||null===(t=A.stage)||void 0===t||null===(l=t.code)||void 0===l||null===(n=l.toString())||void 0===n?void 0:n.toLowerCase()){case O.c.REGULAR:C="10";break;case O.c.BRONZE:C="20";break;case O.c.SILVER:C="30";break;case O.c.GOLD:C="40";break;case O.c.PLATINUM:C="50";break;default:C="01"}Object(a.useEffect)((()=>{if(p&&A){let t="";var e;if(C&&(t=t.concat(O.b.stageNumber,C)),null!==p&&void 0!==p&&p.MilesMemberId&&(t=t.concat(O.b.milesMemberId,h.g,"4",null===p||void 0===p?void 0:p.MilesMemberId)),t=t.concat(O.b.expirationTime,E()),null!==p&&void 0!==p&&p.PontaId)t=t.concat(O.b.pontaId,null===p||void 0===p||null===(e=p.PontaId)||void 0===e?void 0:e.slice(-15));null!==p&&void 0!==p&&p.KFC_Card&&(t=t.concat(O.b.kfcCard,null===p||void 0===p?void 0:p.KFC_Card,null===p||void 0===p?void 0:p.KFC_PIN)),null!==p&&void 0!==p&&p.RakutenId&&"-1"!==(null===p||void 0===p?void 0:p.RakutenId)&&(t=t.concat(O.b.rakutenId,null===p||void 0===p?void 0:p.RakutenId));const l=T(t);g(l)}}),[p,A]);const T=e=>{const t=b.a.enc.Utf8.parse(Object(m.a)(v.rb)),l=b.a.AES.encrypt(e,t,{keySize:16,BlockSize:128,mode:b.a.mode.ECB,padding:b.a.pad.Pkcs7}).toString();var a="";return a=a.concat("K|",l,"|")},E=()=>{function e(e){return e<10?"0".concat(e):e}const t=new Date,l=new Date(t.getTime()+9e5),a=l.getFullYear().toString().slice(-2),c=e(l.getMonth()+1),n=e(l.getDate()),s=e(l.getHours()),i=e(l.getMinutes()),r=e(l.getSeconds());return"".concat(a).concat(c).concat(n).concat(s).concat(i).concat(r)};return Object(r.jsx)(r.Fragment,{children:p&&Object(r.jsx)("div",{className:"loyalty-qr",children:Object(r.jsxs)("div",{className:"loyalty-qr-wrap",children:[null!==p&&void 0!==p&&p.MilesUUID&&null!==A&&void 0!==A&&A.stage?(M=k,S=N,L=e.qrSize,"00:00"!==M?S&&Object(r.jsx)(s.a,{size:L,value:S}):Object(r.jsx)("div",{className:"qr-placeholder"})):Object(r.jsx)("div",{className:"placeholder",children:Object(r.jsx)("div",{className:"qr-placeholder loading"})}),Object(r.jsx)("div",{className:"pnl-refresh",children:null!==p&&void 0!==p&&p.MilesUUID&&null!==A&&void 0!==A&&A.stage?Object(r.jsxs)(c.a.Fragment,{children:[Object(r.jsx)("div",{id:"qr-timer",children:Object(r.jsx)(o,{timer:k,setTimer:_,restartTimer:I,setRestartTimer:y})}),Object(r.jsx)("button",{id:"btn-refresh-qr",className:"kfc-button btn-black",onClick:()=>{f(Object(u.e)()),x(!0),setTimeout((()=>{x(!1),y(!0)}),1e3)},children:Object(r.jsx)("img",{src:i.a,alt:"refresh",className:(R=j,R?"rotate":"")})})]}):Object(r.jsx)("div",{className:"placeholder",children:Object(r.jsx)("div",{className:"qr-timer-placeholder loading"})})})]})})});var R,M,S,L};x.defaultProps={qrSize:192};var N=x,g=l(75),I=l(6),y=l(4),p=l(86);var A=e=>{var t,l,a,c,n,s,i,o,j;let{setStep:b,isNewVersionStyle:u}=e;const{LEARN_MORE:h,CUMULATIVE_MILES:x,CONGRATULATIONS_TOP_STAGE:N,TO:A,LEVEL:f,CUMULATIVE_CHICKEN_MILES:k,AFTER:_,IN_MILE:C,MEMBER:T,EXPIRATION_DATE:E,ABOUT_CHICKEN_MILE:R,CHICKEN_MILES:M,CUMULATIVE:S}=y.a,L=Object(d.c)((e=>{var t;return null===e||void 0===e||null===(t=e.loyaltyMileageReducer)||void 0===t?void 0:t.pickedData})),D=Object(d.c)((e=>{var t;return null===e||void 0===e||null===(t=e.loyaltyMileageReducer)||void 0===t?void 0:t.isLoading})),w=Object(d.c)((e=>{var t;return null===e||void 0===e||null===(t=e.loyaltyMileageReducer)||void 0===t?void 0:t.userOverAllRankingData})),W=(null===w||void 0===w||w.mile,Object(d.c)((e=>{var t;return null===e||void 0===e||null===(t=e.loyaltyMileageReducer)||void 0===t?void 0:t.monthlyRankingData}))),{user:K}=W||{},{total_mile:P,ends_at:U}=K||{},F=null===L||void 0===L||null===(t=L.next_stage)||void 0===t?void 0:t.lower,B=null===L||void 0===L?void 0:L.current_mile,H=B/F*100,G=F-B,V=(null===L||void 0===L||null===(l=L.stage)||void 0===l||null===(a=l.code)||void 0===a||null===(c=a.toString())||void 0===c?void 0:c.toLowerCase())===O.c.PLATINUM,q=document.getElementById("current-mile-portal"),z=Object(r.jsxs)("div",{className:"current-mile",children:[null===L||void 0===L||null===(n=L.stage)||void 0===n?void 0:n.name," ",Object(I.translateWithI18Next)(f)]});return Object(r.jsxs)("div",{className:"loyalty-status px-0",children:[Object(r.jsx)("div",{className:"loyalty-heading",children:null!==L&&void 0!==L&&null!==(s=L.stage)&&void 0!==s&&s.name?Object(r.jsxs)("div",{className:"text-center",children:[q?Object(g.createPortal)(z,q):z,u?Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)("div",{className:"d-flex justify-content-between align-items-end",children:[Object(r.jsx)("div",{className:"status-miles-text font-weight-bold",children:Object(I.translateWithI18Next)(S)}),Object(r.jsx)("div",{className:"status-miles-value",children:P}),Object(r.jsx)("div",{className:"status-miles-text font-weight-bold",children:Object(I.translateWithI18Next)(M)})]}),Object(r.jsx)("div",{className:"lbl-mileage-expiration font-weight-bold",children:"".concat(Object(I.translateWithI18Next)(E)," ").concat(Object(p.b)(U))})]}):Object(r.jsx)("div",{className:"current-mile-value",children:null===L||void 0===L?void 0:L.current_mile})]}):Object(r.jsx)("div",{className:"placeholder m-0 ".concat(u?"loyalty-status-skeleton":""),children:Object(r.jsx)("div",{className:"line sm  ".concat(u?"skeleton-loading":"")})})}),Object(r.jsx)("div",{className:"meter",children:null!==L&&void 0!==L&&L.current_mile?Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("span",{style:{width:"".concat(V?"100":H,"%")}}),u&&Object(r.jsx)("div",{className:"meter-miles-conteiner-text position-absolute font-weight-bold",children:V?Object(I.translateWithI18Next)(N):Object(r.jsxs)(r.Fragment,{children:[Object(I.translateWithI18Next)(_)," ",Object(r.jsx)("span",{className:"meter-miles-value",children:G})," ",null===L||void 0===L||null===(i=L.next_stage)||void 0===i?void 0:i.name," ",Object(I.translateWithI18Next)(T)]})})]}):Object(r.jsx)("div",{className:"placeholder m-0",children:Object(r.jsx)("div",{className:"status loading"})})}),u?Object(r.jsx)(r.Fragment,{children:" "}):Object(r.jsx)("div",{className:"lbl-note-light",children:null!==L&&void 0!==L&&null!==(o=L.next_stage)&&void 0!==o&&o.name||V?Object(r.jsxs)("div",{className:"d-flex justify-content-between",children:[Object(r.jsxs)("div",{className:"cumulative-container w-50",children:[Object(r.jsx)("div",{className:"status-miles-value",children:P}),Object(r.jsx)("div",{className:"status-miles-text",children:Object(I.translateWithI18Next)(x)})]}),Object(r.jsx)("div",{className:"w-50",children:V?Object(I.translateWithI18Next)(N):Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)("div",{className:"status-miles-value",children:[Object(r.jsx)("span",{className:"status-miles-text",children:Object(I.translateWithI18Next)(_)}),G,Object(r.jsx)("span",{className:"status-miles-text",children:Object(I.translateWithI18Next)(C)})]}),Object(r.jsxs)("div",{className:"status-miles-text",children:[null===L||void 0===L||null===(j=L.next_stage)||void 0===j?void 0:j.name," ",Object(I.translateWithI18Next)(T)]})]})})]}):Object(r.jsx)("div",{className:"placeholder justify-content-start m-0",children:Object(r.jsx)("div",{className:"line md loading"})})}),u?Object(r.jsx)("div",{className:"lbl-mileage-link font-weight-bold",children:Object(r.jsx)("a",{className:"lbl-mileage-link-item",href:"".concat(Object(m.a)(v.Ub)),children:"".concat(Object(I.translateWithI18Next)(R))})}):Object(r.jsx)("button",{disabled:D,onClick:()=>{b(O.d.MILE_DETAILS)},className:"btn-loyalty-details btn-sm p-0",children:"".concat(Object(I.translateWithI18Next)(h))})]})},f=l(46),k=l(15),_=l(5);var C=e=>{let{cardImg:t,disabled:l,cardTitle:a="",isLinked:c=!1,cardRedirect:n,setStep:s,onClick:i,isLinkingStatue:o,availablePoints:j,cardType:b}=e;const{LINKED:u,NOT_LINKED:v,DETAILS:m,LINKING:h,LINKING_IN_PROGRESS:x,WORK_TOGETHER:N,ALREADY_LINKED:g,COMING_SOON:p}=y.a,A=Object(d.c)((e=>{var t;return null===e||void 0===e||null===(t=e.loyaltyMileageReducer)||void 0===t?void 0:t.userMiles})),_=Object(d.c)((e=>{var t;return null===e||void 0===e||null===(t=e.tenantReducer)||void 0===t?void 0:t.rakutenComingSoon}));let C=!1;const T=Object(d.c)((e=>{var t;return null===e||void 0===e||null===(t=e.loyaltyMileageReducer)||void 0===t?void 0:t.isLoading}));let E=Object(I.translateWithI18Next)(v);return b===O.a.RAKUTEN?(C=_,o?E=Object(I.translateWithI18Next)(x):c&&(E=Object(I.translateWithI18Next)(g))):c&&(E=Object(I.translateWithI18Next)(u)),Object(r.jsxs)("div",{className:"linkage-card",children:[Object(r.jsx)("img",{src:t,alt:a}),Object(r.jsxs)("span",{className:"linkage-title",children:[Object(r.jsx)("span",{className:"linkage-title-text",children:a}),null!==A&&void 0!==A&&A.MilesUUID||c?Object(r.jsx)("span",{className:"linkage-status",children:E}):Object(r.jsx)("span",{className:"linkage-status",children:Object(I.translateWithI18Next)(v)})]}),!o&&Object(r.jsxs)("button",{disabled:l||T||C,className:"linkage-btn btn-link",onClick:i,children:[!c&&!T&&!C&&Object(r.jsx)(f.a,{srcFile:k.a.External_url,alt:"External url",className:"details-icon"})," ",Object(r.jsx)("span",{children:C?Object(I.translateWithI18Next)(p):c?Object(I.translateWithI18Next)(m):Object(I.translateWithI18Next)(N)})]})]})},T=l(62),E=l(0),R=l(1235);var M=e=>{let{setStep:t,setCartType:l,showConfirmationModal:c,setShowConfirmationModal:n,handleUnlinkedAction:s}=e;const{KFC_CARD:i,PONTA_POINTS:o,RAKUTEN_POINTS:j,LINKED_TO_CARD_MESSAGE:b,UNLINK_CONFIRMATION_MESSAGE:v}=y.a,m=Object(d.b)(),h=Object(T.g)(),x=Object(d.c)((e=>{var t;return null===e||void 0===e||null===(t=e.loyaltyMileageReducer)||void 0===t?void 0:t.userMiles})),N=Object(d.c)((e=>{var t;return null===e||void 0===e||null===(t=e.loyaltyMileageReducer)||void 0===t?void 0:t.pontaAccountID})),g=(null===x||void 0===x?void 0:x.KFC_Card)&&(null===x||void 0===x?void 0:x.KFC_PIN),p=null===x||void 0===x?void 0:x.PontaId,A=null===x||void 0===x?void 0:x.RakutenId,f=Object(d.c)((e=>e.profileReducer)),M=Object(_.Zb)("".concat(E.gd.CARD_ATTEMPT_DATA,"-").concat(null===f||void 0===f?void 0:f.customerId)),S=(null===M||void 0===M?void 0:M.isUserBlocked)||!1,[L,D]=Object(a.useState)(S),[w,W]=Object(a.useState)(""),K="-1"===A,P=Object(d.c)((e=>{var t;return null===e||void 0===e||null===(t=e.loyaltyMileageReducer)||void 0===t?void 0:t.kfcLinkingData})),{BalanceAfter:U}=P||{},F=Object(d.c)((e=>{var t,l;return null===e||void 0===e||null===(t=e.loyaltyMileageReducer)||void 0===t||null===(l=t.rakutenBalanceInquiry)||void 0===l?void 0:l.AvailablePoints})),B=Object(d.c)((e=>{var t,l;return null===e||void 0===e||null===(t=e.loyaltyMileageReducer)||void 0===t||null===(l=t.pontaBalanceInquiry)||void 0===l?void 0:l.AvailablePoints}));Object(a.useEffect)((()=>{H()}),[]);const H=()=>{var e;const t=null===(e=Object(_.Zb)("".concat(E.gd.CARD_ATTEMPT_DATA,"-").concat(null===f||void 0===f?void 0:f.customerId)))||void 0===e?void 0:e.lastAttemptDate,l=new Date;l.setHours(0,0,0,0),t!==l.toDateString()&&(Object(_.xf)("".concat(E.gd.CARD_ATTEMPT_DATA,"-").concat(null===f||void 0===f?void 0:f.customerId),{isUserBlocked:!1,attemptsCount:0,lastAttemptDate:l.toDateString()}),D(!1))};return Object(a.useEffect)((()=>{A&&m(Object(u.j)({memberId:A}))}),[A]),Object(a.useEffect)((()=>{p&&m(Object(u.i)({memberId:p}))}),[p]),Object(r.jsxs)("div",{className:"linkage-cards",children:[Object(r.jsx)(C,{cardImg:k.a.HeaderLogo,isLinked:g,cardTitle:Object(I.translateWithI18Next)(i),setStep:t,disabled:L,onClick:()=>{g?(t(O.d.CARD_DETAILS_VIEW),l(O.a.KFC)):t(O.d.KFC_FORM)},availablePoints:U,cardType:O.a.KFC}),Object(r.jsx)(C,{cardImg:k.a.PontaLogo,isLinked:p,cardTitle:Object(I.translateWithI18Next)(o),onClick:()=>{A?(W(O.a.RAKUTEN),n(!0)):(p?(t(O.d.CARD_DETAILS_VIEW),l(O.a.PONTA)):m(Object(u.h)(N)),W(""),n(!1))},availablePoints:B,cardType:O.a.PONTA}),Object(r.jsx)(C,{isLinked:A,isLinkingStatue:K,cardImg:k.a.RakutenLogo,cardTitle:Object(I.translateWithI18Next)(j),onClick:()=>{p?(W(O.a.PONTA),n(!0)):(A?(t(O.d.CARD_DETAILS_VIEW),l(O.a.RAKUTEN)):h.push({pathname:"/rakuten-tc"}),W(""),n(!1))},availablePoints:F,cardType:O.a.RAKUTEN}),c&&Object(r.jsx)(R.a,{confirmationMsg:Object(I.translateWithI18Next)(b),handleClose:()=>n(!1),handleConfirmBtn:()=>s(w)})]})};var S=e=>{let{setStep:t,setCartType:l,showConfirmationModal:a,setShowConfirmationModal:c,handleUnlinkedAction:n}=e;return Object(r.jsx)("div",{className:"loyalty-linkage",children:Object(r.jsx)(M,{setStep:t,setCartType:l,setShowConfirmationModal:c,handleUnlinkedAction:n,showConfirmationModal:a})})};var L=e=>{var t,l,a,c,n,s,i;let{totalMile:o,expDate:j}=e;const{CHICKEN_MILES:b,CONGRATULATIONS_TOP_STAGE:u,STAGE_WITH:h,LEVEL:x,EXPIRATION_DATE:N,WHAT_IS_CHICKEN_MILE:g,CUMULATIVE_MILES:A,AFTER:f,MEMBER:k,IN_MILE:_}=y.a,C=Object(d.c)((e=>{var t;return null===e||void 0===e||null===(t=e.loyaltyMileageReducer)||void 0===t?void 0:t.pickedData})),T=null===C||void 0===C||null===(t=C.next_stage)||void 0===t?void 0:t.lower,E=null===C||void 0===C?void 0:C.current_mile,R=Object(d.c)((e=>{var t;return null===e||void 0===e||null===(t=e.loyaltyMileageReducer)||void 0===t?void 0:t.userOverAllRankingData})),M=(null===R||void 0===R||R.mile,Object(d.c)((e=>{var t;return null===e||void 0===e||null===(t=e.loyaltyMileageReducer)||void 0===t?void 0:t.monthlyRankingData}))),{user:S}=M||{},{total_mile:L}=S||{},D=E/T*100,w=T-E,W=(null===C||void 0===C||null===(l=C.stage)||void 0===l||null===(a=l.code)||void 0===a?void 0:a.toLowerCase())===O.c.PLATINUM;return Object(r.jsxs)("div",{children:[Object(r.jsx)("div",{className:"loyalty-heading",children:null!==C&&void 0!==C&&null!==(c=C.stage)&&void 0!==c&&c.name?Object(r.jsxs)("div",{className:"text-center",children:[Object(r.jsxs)("h3",{className:"current-mile",children:[null===C||void 0===C||null===(n=C.stage)||void 0===n?void 0:n.name," ",Object(I.translateWithI18Next)(x)]}),Object(r.jsx)("div",{className:"current-mile-value",children:null===C||void 0===C?void 0:C.current_mile})]}):Object(r.jsx)("div",{className:"placeholder m-0",children:Object(r.jsx)("div",{className:"line sm loading"})})}),Object(r.jsx)("div",{className:"meter",children:Object(r.jsx)("span",{style:{width:"".concat(D,"%")}})}),Object(r.jsx)("div",{className:"lbl-note-light",children:null!==C&&void 0!==C&&null!==(s=C.next_stage)&&void 0!==s&&s.name||W?Object(r.jsxs)("div",{className:"d-flex justify-content-between",children:[Object(r.jsxs)("div",{className:"cumulative-container w-50",children:[Object(r.jsx)("div",{className:"status-miles-value",children:L}),Object(r.jsx)("div",{className:"status-miles-text",children:Object(I.translateWithI18Next)(A)})]}),Object(r.jsx)("div",{className:"w-50",children:W?Object(I.translateWithI18Next)(u):Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)("div",{className:"status-miles-value",children:[Object(r.jsx)("span",{className:"status-miles-text",children:Object(I.translateWithI18Next)(f)}),w,Object(r.jsx)("span",{className:"status-miles-text",children:Object(I.translateWithI18Next)(_)})]}),Object(r.jsxs)("div",{className:"status-miles-text",children:[null===C||void 0===C||null===(i=C.next_stage)||void 0===i?void 0:i.name," ",Object(I.translateWithI18Next)(k)]})]})})]}):Object(r.jsx)("div",{className:"placeholder justify-content-start m-0",children:Object(r.jsx)("div",{className:"line md loading"})})}),Object(r.jsxs)("div",{className:"d-flex justify-content-between align-items-center mt-4",children:[Object(r.jsx)("div",{className:"lbl-mileage-expiration",children:"".concat(Object(I.translateWithI18Next)(N)," ").concat(Object(p.b)(j))}),Object(r.jsx)("div",{className:"lbl-mileage-link",children:Object(r.jsx)("a",{className:"lbl-mileage-link-item",href:"".concat(Object(m.a)(v.Ub)),children:"".concat(Object(I.translateWithI18Next)(g))})})]})]})},D=l(1364),w=l(1365),W=l(1283),K=l(1277);var P=e=>{let{Date:t,Title:l,Points:a}=e;const{CHICKEN_MILES:c}=y.a;return Object(r.jsxs)("div",{className:"loyalty-history-item",children:[Object(r.jsxs)("div",{className:"loyalty-history-date",children:[Object(r.jsx)("label",{children:t}),Object(r.jsx)("p",{children:l})]}),Object(r.jsx)("div",{className:"loyalty-history-point d-flex align-items-end",children:Object(r.jsxs)("div",{className:"d-flex align-items-center",children:[a," ",Object(r.jsx)("span",{className:"lbl-point",children:Object(I.translateWithI18Next)(c)})]})})]})};const U=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce(((e,t)=>e+(t.rule_name.length>37?t.rule_name.length/37*37:37)+20),0)>285},F=e=>{let{isNewVersionStyle:t}=e;const{pastMilesHisory:l,currentMilesHisory:c}=Object(d.c)((e=>null===e||void 0===e?void 0:e.loyaltyMileageReducer)),{PAST_TAB_TITLE:n,THE_CURRENT_TAB_TITLE:s}=y.a,[i,o]=Object(a.useState)("current"),j=e=>e&&e.length?e.map((e=>{return Object(r.jsx)(P,{Date:(l=e.issue_date,t?Object(p.b)(l):new Date(l).toLocaleDateString()),Title:e.rule_name,Points:e.mile},"".concat(e.rule_name,"-").concat(e.mile));var l})):Object(r.jsx)("div",{className:"no-history-data",children:"No Data"});return Object(r.jsx)("div",{className:"ranking-tabs ".concat(t&&U("current"===i?c||[]:l||[])?"has-scroll":""),style:t?{}:{paddingTop:"1.5rem"},children:Object(r.jsxs)(W.a,{defaultActiveKey:"current",id:"uncontrolled-tab-example",className:"loyalty-tabs",onSelect:e=>{o(e)},children:[Object(r.jsx)(K.a,{eventKey:"current",title:Object(I.translateWithI18Next)(s),children:j(c)}),Object(r.jsx)(K.a,{eventKey:"past",title:Object(I.translateWithI18Next)(n),children:j(l)})]})})};F.defaultProps={isNewVersionStyle:!1};var B=F;const H=(e,t)=>{var l;return"".concat(null===(l=e[0])||void 0===l?void 0:l.rank," ").concat(Object(I.translateWithI18Next)(t))};var G=e=>{var t,l,a;let{setStep:c}=e;const n=Object(d.c)((e=>{var t;return null===e||void 0===e||null===(t=e.loyaltyMileageReducer)||void 0===t?void 0:t.monthlyRankingData})),{user:s,ranking:i}=n||{},{total_mile:o,ends_at:j}=s||{},b=Object(d.c)((e=>{var t;return null===e||void 0===e||null===(t=e.loyaltyMileageReducer)||void 0===t?void 0:t.pickedData})),u=(null===b||void 0===b||null===(t=b.stage)||void 0===t||null===(l=t.code)||void 0===l?void 0:l.toLowerCase())||O.c.REGULAR.toLowerCase(),v=Object(d.c)((e=>null===e||void 0===e?void 0:e.tenantReducer)),{showAllRanking:m}=v,{CHICKEN_MILE_DETAILS:h,RANKING_OF_MONTH:x,PLACE:N,VIEW_ALL:g}=y.a;return Object(r.jsx)("div",{className:"loyalty-miles w-100",children:Object(r.jsxs)(D.a,{className:"justify-content-center w-100 m-0",children:[Object(r.jsxs)(w.a,{xs:"12",className:"d-lg-none",children:[Object(r.jsx)("button",{onClick:()=>c(O.d.Home),className:"btn-back",children:"\u2794"}),Object(r.jsx)("h2",{children:Object(I.translateWithI18Next)(h)})]}),Object(r.jsx)(w.a,{lg:"5",xs:"12",className:"loyalty-mile-details ".concat(u),children:Object(r.jsx)(L,{totalMile:o,expDate:j})}),Object(r.jsxs)(w.a,{lg:"7",xs:"12",children:[Object(r.jsx)("div",{className:"loyalty-ranking",children:Object(r.jsxs)("div",{className:"loyalty-heading",children:[Object(r.jsxs)("h3",{children:[Object(r.jsx)("img",{src:k.a.CrownRankLogo,alt:"Ranking of the month"}),Object(r.jsx)("span",{className:"ranking-crown-heading",children:Object(I.translateWithI18Next)(x)})]}),m?Object(r.jsx)("button",{className:"btn-link btn-sm",onClick:()=>c(O.d.RANKING),children:"".concat(i&&null!==(a=i[0])&&void 0!==a&&a.rank?H(i,N):Object(I.translateWithI18Next)(g))}):null]})}),Object(r.jsx)(B,{})]})]})})},V=l(1233);var q=e=>{let{Rank:t,Points:l,Img:a,hasImg:c=!1}=e;const{CHICKEN_MILES:n}=y.a;return Object(r.jsxs)("div",{className:"loyalty-history-item  d-flex align-items-center",children:[Object(r.jsx)("div",{className:"loyalty-history-rank",children:c?Object(r.jsx)("img",{src:a,alt:"Rank"}):Object(r.jsx)(r.Fragment,{children:Object(r.jsx)("p",{children:t})})}),Object(r.jsxs)("div",{className:"loyalty-history-point d-flex align-items-center",children:[Object(r.jsx)("span",{children:l})," ",Object(r.jsx)("span",{className:"lbl-point",children:Object(I.translateWithI18Next)(n)})]})]},t)};var z=e=>{let{Date:t,Rank:l}=e;return Object(r.jsxs)("div",{className:"loyalty-history-item",children:[Object(r.jsx)("div",{className:"loyalty-history-rank",children:t}),Object(r.jsx)("div",{className:"loyalty-history-rank",children:l})]},l)},Y=l(429),Z=l(41),$=l(32);var X=e=>{let{title:t,handleConfirmBtn:l,handleClose:a,content:c}=e;return Object(r.jsx)(r.Fragment,{children:Object(r.jsx)(Y.a,{id:"PastRanking",show:!0,classNames:"ranking-modal",showCloseBtn:!0,closeButtonHandler:a,closeDataTestId:"handler-close",autoFocus:!0,handleClose:!0,buttonVariant:Z.b.primary,footerBtnText:Object($.translateWithI18Next)(y.a.BACK_BUTTON),footerBtnHandler:l,showFooterSection:!0,modalTitle:t,children:c})})};const J=e=>{if(e>=11&&e<=13)return e+"th";switch(e%10){case 1:return e+"st";case 2:return e+"nd";case 3:return e+"rd";default:return e+"th"}},Q=e=>{switch(e){case 1:return k.a.IconGold;case 2:return k.a.IconSilver;case 3:return k.a.IconBronze;default:return""}};var ee=e=>{var t,l,n;let{setStep:s,stageColor:i}=e;const{CHICKEN_MILES:o,CUMULATIVE_CHICKEN_MILES:j,ALL_RANKING:b,PAST_MONTH_RESULT:u,YOUR_RANKING:v,PAST_MONTHLY_PERFORMANCE:m,MONTHLY_CHICKEN_MILES:h,NO_PAST_DATA:x,NO_DATA:N,PLACE:g,CHICKEN_MILE_DETAILS:p,RANKING_TAB_TITLE:A,COMPREHENSIVE_TAB_TITLE:f}=y.a,[_,C]=Object(a.useState)(!1),T=Object(d.c)((e=>{var t;return null===e||void 0===e||null===(t=e.loyaltyMileageReducer)||void 0===t?void 0:t.rankingViewData})),E={},R=(null===T||void 0===T?void 0:T.filter((e=>{const t="".concat(e.rank,"-").concat(e.value);return!E[t]&&(E[t]=!0,!0)})))||[],M=Object(d.c)((e=>{var t;return null===e||void 0===e||null===(t=e.loyaltyMileageReducer)||void 0===t?void 0:t.overAllRankingData})),S=Object(d.c)((e=>{var t;return null===e||void 0===e||null===(t=e.loyaltyMileageReducer)||void 0===t?void 0:t.userOverAllRankingData})),L=Object(d.c)((e=>{var t;return null===e||void 0===e||null===(t=e.loyaltyMileageReducer)||void 0===t?void 0:t.monthlyRankingData})),{ranking:D}=L||{},w=null!==(t=D[0])&&void 0!==t&&t.rank?"".concat(J(Number(null===(l=D[0])||void 0===l?void 0:l.rank))," ").concat(Object(I.translateWithI18Next)(g)):"-",P=null!==S&&void 0!==S&&S.rank?"".concat(J(null===S||void 0===S?void 0:S.rank)," ").concat(Object(I.translateWithI18Next)(g)):"-",{user:U}=(null===S||void 0===S||S.mile,L||{}),{total_mile:F}=U||{},B=null===(n=D[0])||void 0===n?void 0:n.mile,H=new Date,G=H.getFullYear(),Y=(H.getMonth()+1).toString().padStart(2,"0"),Z=("1/".concat(Y,"/").concat(G),Object(d.c)((e=>{var t;return null===e||void 0===e||null===(t=e.loyaltyMileageReducer)||void 0===t?void 0:t.pastMonthlyRankingData}))),$=null===Z||void 0===Z?void 0:Z.ranking,ee=((e,t)=>e?Object(r.jsxs)(c.a.Fragment,{children:[e," ",Object(r.jsx)("span",{className:"lbl-point",children:Object(I.translateWithI18Next)(t)})]}):"-")(B,o);return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)(V.a,{lg:"5",xs:"12",children:[Object(r.jsx)("div",{children:Object(r.jsxs)("button",{onClick:()=>{_?C(!1):s(O.d.MILE_DETAILS)},className:"d-flex back-to-mileage-loyalty-details show-qr-btn btn-back align-items-center",children:[Object(r.jsx)("img",{className:"back-CTA-Arrow",src:k.a.CTA_Arrow,alt:"back-btn"})," ",Object(r.jsx)("h2",{children:Object(I.translateWithI18Next)(p)})]})}),Object(r.jsxs)("div",{className:"mb-lg-0 mb-4 mileage-loyalty-status ".concat(i),children:[Object(r.jsx)("div",{className:"loyalty-status px-0",children:Object(r.jsx)("div",{className:"loyalty-heading",children:w?Object(r.jsxs)("div",{className:"text-center",children:[Object(r.jsx)("h3",{className:"current-mile",children:Object(I.translateWithI18Next)(v)}),Object(r.jsx)("div",{className:"current-mile-value",children:w})]}):Object(r.jsx)("div",{className:"placeholder m-0",children:Object(r.jsx)("div",{className:"line sm loading"})})})}),Object(r.jsx)("div",{className:"loyalty-status px-0",children:Object(r.jsx)("div",{className:"loyalty-heading",children:ee?Object(r.jsxs)("div",{className:"text-center",children:[Object(r.jsx)("h3",{className:"current-mile",children:Object(I.translateWithI18Next)(h)}),Object(r.jsx)("div",{className:"current-mile-value",children:ee})]}):Object(r.jsx)("div",{className:"placeholder m-0",children:Object(r.jsx)("div",{className:"line sm loading"})})})})]})]}),Object(r.jsx)(V.a,{lg:"7",xs:"12",children:Object(r.jsxs)("div",{className:"loyalty-ranking-history w-100",children:[Object(r.jsxs)("div",{className:"d-flex justify-content-between",children:[Object(r.jsx)("h2",{children:Object(I.translateWithI18Next)(b)}),Object(r.jsx)("button",{className:"btn-link btn-sm",id:"btn-viewpastranking",onClick:()=>C(!0),children:"\u27a4 ".concat(Object(I.translateWithI18Next)(m))})]}),_?Object(r.jsx)(X,{title:Object(I.translateWithI18Next)(u),content:Object(r.jsx)(c.a.Fragment,{children:Object(r.jsx)("div",{style:{padding:"1rem"},children:Object(r.jsx)("div",{id:"ranking-pastranking",children:$&&$.length?$.map((e=>Object(r.jsx)(z,{Date:e.target_date,Rank:e.rank}))):Object(r.jsx)("div",{className:"loyalty-history-item no-data",children:Object(I.translateWithI18Next)(x)})})})}),handleClose:()=>C(!1),handleConfirmBtn:()=>C(!1)}):Object(r.jsx)("div",{className:"py-4",children:Object(r.jsxs)(W.a,{defaultActiveKey:"month",id:"uncontrolled-tab-example",className:"loyalty-tabs",children:[Object(r.jsx)(K.a,{eventKey:"month",title:Object(I.translateWithI18Next)(A),children:Object(r.jsx)("div",{id:"list-rankingthismonth",children:R&&R.length?R.map((e=>{const t=J(null===e||void 0===e?void 0:e.rank),l=1===(null===e||void 0===e?void 0:e.rank)||2===(null===e||void 0===e?void 0:e.rank)||3===(null===e||void 0===e?void 0:e.rank),a=Q(null===e||void 0===e?void 0:e.rank);return Object(r.jsx)(q,{Rank:t,Points:e.mile,hasImg:l,Img:a})})):Object(r.jsx)("div",{className:"loyalty-history-item no-data",children:Object(I.translateWithI18Next)(N)})})}),Object(r.jsxs)(K.a,{eventKey:"comprehensive",title:Object(I.translateWithI18Next)(f),children:[Object(r.jsx)("div",{className:"loyalty-ranking",children:Object(r.jsxs)("div",{className:"loyalty-heading",children:[Object(r.jsxs)("div",{className:"loyalty-history-item",children:[Object(r.jsxs)("h3",{children:[Object(r.jsx)("img",{src:k.a.CrownRankLogo,alt:"your ranking"}),Object(I.translateWithI18Next)(v)]}),Object(r.jsx)("div",{children:P})]}),Object(r.jsxs)("div",{className:"loyalty-history-item",children:[Object(r.jsx)("div",{children:Object(I.translateWithI18Next)(j)}),Object(r.jsxs)("div",{className:"loyalty-history-point",children:[F," ",Object(r.jsx)("span",{className:"lbl-point",children:Object(I.translateWithI18Next)(o)})]})]})]})}),Object(r.jsx)("div",{id:"list-rankingthismonth",children:M&&M.length?M.map((e=>{const t=J(null===e||void 0===e?void 0:e.rank),l=1===(null===e||void 0===e?void 0:e.rank)||2===(null===e||void 0===e?void 0:e.rank)||3===(null===e||void 0===e?void 0:e.rank),a=Q(null===e||void 0===e?void 0:e.rank);return Object(r.jsx)(q,{Rank:t,Points:e.mile,hasImg:l,Img:a})})):Object(r.jsx)("div",{className:"loyalty-history-item no-data",children:Object(I.translateWithI18Next)(N)})})]})]})})]})})]})};var te=e=>{let{inputId:t,placeholder:l,type:a,minLength:c,maxLength:n,labelTxt:s,value:i,errorMsg:o,errorIcon:d="",handleOnChange:j}=e;return Object(r.jsxs)("div",{className:"loyalty-fields",children:[Object(r.jsxs)("div",{className:"field material-input",children:[Object(r.jsx)("input",{id:t,placeholder:l,maxLength:n,type:a,value:i,onChange:j}),Object(r.jsx)("label",{for:t,children:s})]}),o&&Object(r.jsxs)("div",{className:"kfc-link-form-error",children:[Object(r.jsx)(f.a,{srcFile:k.a.Error,className:"location-alert-icon mr-1"}),Object(r.jsx)("div",{className:"error-msg",children:o})]})]})};var le=e=>{let{setStep:t}=e;const[l,c]=Object(a.useState)(!1),n=Object(d.b)(),s=Object(d.c)((e=>{var t;return null===e||void 0===e||null===(t=e.loyaltyMileageReducer)||void 0===t?void 0:t.loading})),i=Object(d.c)((e=>{var t;return null===e||void 0===e||null===(t=e.loyaltyMileageReducer)||void 0===t?void 0:t.errorMsg})),o=Object(d.c)((e=>{var t,l;return null===e||void 0===e||null===(t=e.loyaltyMileageReducer)||void 0===t||null===(l=t.kfcLinkingData)||void 0===l?void 0:l.BalanceAfter})),j=Object(d.c)((e=>e.profileReducer)),b=Object(_.Zb)("".concat(E.gd.CARD_ATTEMPT_DATA,"-").concat(null===j||void 0===j?void 0:j.customerId)),h=(null===b||void 0===b?void 0:b.isUserBlocked)||!1,x=(null===b||void 0===b?void 0:b.attemptsCount)||0,[N,g]=Object(a.useState)(""),[p,A]=Object(a.useState)(""),[C,T]=Object(a.useState)(""),[R,M]=Object(a.useState)(h?"Block error msg":""),[S,L]=Object(a.useState)(""),[D,w]=Object(a.useState)(!1),{KFC_CARD_COOPERATION:W,ENTER_ID_AND_PIN:K,WRONG_PIN_LIMIT:P,ABOUT_KFC_CARD:U,RETURN:F,SUBMIT:B,KFC_CARD_HAS_NO_BALANCE:H,BLOCK_ERROR_MESSAGE:G,CARD_NUMBER_VALIDATION_MESSAGE:V,PIN_NUMBER_VALIDATION_MESSAGE:q,CARD_NUMBER_LABEL:z,PIN_NUMBER_LABEL:Y,LINK_CARD:$}=y.a;Object(a.useEffect)((()=>{l&&(s||i||t(O.d.Home))}),[s,i,t,l]),Object(a.useEffect)((()=>{n(Object(u.b)())}),[]),Object(a.useEffect)((()=>{X()}),[o]);const X=async()=>{n(Object(u.l)(!1)),o<=0?(n(Object(u.k)(Object(I.translateWithI18Next)(H))),J(),n(Object(u.b)())):o>0&&Object(_.xf)("".concat(E.gd.CARD_ATTEMPT_DATA,"-").concat(null===j||void 0===j?void 0:j.customerId),{isUserBlocked:!1,attemptsCount:0})},J=()=>{(()=>{var e;const t=null===(e=Object(_.Zb)("".concat(E.gd.CARD_ATTEMPT_DATA,"-").concat(null===j||void 0===j?void 0:j.customerId)))||void 0===e?void 0:e.lastAttemptDate,l=new Date;l.setHours(0,0,0,0),t!==l.toDateString()&&Object(_.xf)("".concat(E.gd.CARD_ATTEMPT_DATA,"-").concat(null===j||void 0===j?void 0:j.customerId),{isUserBlocked:!1,attemptsCount:0,lastAttemptDate:l.toDateString()})})();const e=new Date;e.setHours(0,0,0,0),x<5&&!h?Object(_.xf)("".concat(E.gd.CARD_ATTEMPT_DATA,"-").concat(null===j||void 0===j?void 0:j.customerId),{isUserBlocked:!1,attemptsCount:Number(x)+1,lastAttemptDate:e.toDateString()}):(5===x||x>5)&&(Object(_.xf)("".concat(E.gd.CARD_ATTEMPT_DATA,"-").concat(null===j||void 0===j?void 0:j.customerId),{isUserBlocked:!0,attemptsCount:Number(x),lastAttemptDate:e.toDateString()}),M(Object(I.translateWithI18Next)(G)))};return Object(r.jsxs)("div",{className:"kfc-card-form align-items-center flex-column d-flex",children:[Object(r.jsx)(Z.c,{onClick:()=>t(O.d.Home),className:"btn-back",children:"\u2794"}),Object(r.jsx)("h2",{className:"form-title",children:Object(I.translateWithI18Next)(W)}),Object(r.jsxs)("div",{className:"col-12 col-lg-8 p-0",children:[Object(r.jsx)("p",{children:Object(I.translateWithI18Next)(K)}),R&&Object(r.jsx)("div",{children:R}),i&&Object(r.jsxs)("div",{className:"kfc-link-form-error general-error",children:[Object(r.jsx)(f.a,{srcFile:k.a.Error,className:"location-alert-icon mr-1"}),Object(r.jsx)("div",{className:"error-msg",children:i})]}),Object(r.jsx)(te,{type:"number",labelTxt:Object(I.translateWithI18Next)(z),inputId:"txt-kfccard",placeholder:Object(I.translateWithI18Next)(z),maxLength:50,value:N,errorMsg:C,handleOnChange:e=>{if(h)return;const t=e.target.value;g(t),/^\d{16}$/.test(t)&&/^\d{4}$/.test(p)?w(!0):w(!1)}}),Object(r.jsx)(te,{type:"password",labelTxt:Object(I.translateWithI18Next)(Y),inputId:"txt-kfcpin",placeholder:Object(I.translateWithI18Next)(Y),maxLength:4,value:p,errorMsg:S,handleOnChange:e=>{if(h)return;const t=e.target.value;A(t),/^\d{16}$/.test(N)&&/^\d{4}$/.test(t)?w(!0):w(!1)}}),Object(r.jsx)("div",{className:"loyalty-fields loyalty-fields-btns",children:Object(r.jsx)(Z.c,{"data-type":"primary",className:"button-contained kfc-button ".concat(p&&N?"filled-fields":"empty-fields"," ").concat(s?"loading":""),"data-loading":s,disabled:h||s,onClick:e=>{e.preventDefault(),h||(/^\d{16}$/.test(N)?T(""):T(Object(I.translateWithI18Next)(V)),/^\d{4}$/.test(p)?L(""):L(Object(I.translateWithI18Next)(q)),D?(c(!0),n(Object(u.a)({translateCallback:I.translateWithI18Next,KFC_Card:N,KFC_PIN:p,linking:!0})),n(Object(u.l)(!0))):J())},children:Object(I.translateWithI18Next)($)})}),Object(r.jsx)("p",{style:{textAlign:"center",textDecoration:"underline"},children:Object(r.jsx)("a",{className:"btn-kfc-card btn-link btn-sm",href:"".concat(Object(m.a)(v.a)),children:"".concat(Object(I.translateWithI18Next)(U))})})]})]})},ae=l(1263),ce=l(1278),ne=l(63),se=l(169);const{getInstance:ie}=ne.a,re=()=>Object(r.jsxs)("h3",{className:"d-flex align-items-center font-weight-bold",children:[Object(r.jsx)("img",{src:k.a.CrownRankLogo,alt:"chicken mile log heading"}),Object(r.jsx)("span",{children:Object($.translateWithI18Next)(y.a.RANKING_OF_MONTH)})]}),oe=e=>{let{classes:t}=e;return Object(r.jsx)("div",{className:"".concat(t," skelton-v2 m-inline-auto d-flex justify-content-center"),children:Object(r.jsx)("div",{className:"skeleton-loading"})})},de=e=>{var t;const{hideTitle:l,isNewVersionStyle:c,isMobile:n,pageTitle:s}=e,[i,o]=Object(a.useState)(O.d.Home),[j,b]=Object(a.useState)(O.a.KFC),v=Object(d.b)(),m=Object(d.c)((e=>{var t;return null===e||void 0===e||null===(t=e.loyaltyMileageReducer)||void 0===t?void 0:t.userMiles})),{KFC_Card:h,KFC_PIN:x}=m||{},g=Object(d.c)((e=>{var t;return null===e||void 0===e||null===(t=e.appStateReducer)||void 0===t?void 0:t.userStatus})),[I,p]=Object(a.useState)(!1),[f,_]=Object(a.useState)(!1),C=Object(d.c)((e=>{var t;return null===e||void 0===e||null===(t=e.loyaltyMileageReducer)||void 0===t?void 0:t.linkingStatus})),T=Object(d.c)((e=>{var t;return null===e||void 0===e||null===(t=e.loyaltyMileageReducer)||void 0===t?void 0:t.loading})),{MY_CHICKEN_MILES:E,SHOW_CODE:R,KFC_DETAILS:M,KFC_CARD_LINKING:L,PONTA_DETAILS:W,RAKUTEN_DETAILS:K,CARD_LABEL:P}=y.a,U=Object(d.c)((e=>{var t;return null===e||void 0===e||null===(t=e.loyaltyMileageReducer)||void 0===t?void 0:t.pickedData})),F=Object(d.c)((e=>{var t,l,a,c,n;return null===e||void 0===e||null===(t=e.marketConfigReducer)||void 0===t||null===(l=t.response)||void 0===l||null===(a=l.headerData)||void 0===a||null===(c=a.header)||void 0===c||null===(n=c.fields)||void 0===n?void 0:n.accountLoyaltyColors}))||{},H=((null===F||void 0===F||null===(t=F.fields)||void 0===t?void 0:t.loyaltyColors)||[]).reduce(((e,t)=>(e[t.fields.rank]=t.fields.colorValue,e)),{});Object(a.useEffect)((()=>{m&&m.MilesUUID||(!ie().isValidAccessToken&&null!==g&&void 0!==g&&g.loggedIn&&ne.a.getInstance().refreshAuthentication(),v(Object(u.e)())),h&&x&&v(Object(u.a)({translateCallback:$.translateWithI18Next,KFC_Card:h,KFC_PIN:x,linking:!1}))}),[v,h,x,m]),Object(a.useEffect)((()=>{const e=()=>{const t=document.documentElement.scrollTop||document.body.scrollTop;t>0&&(window.requestAnimationFrame(e),window.scrollTo(0,t-t/8))};i&&e()}),[i]);const V=e=>{v(Object(u.b)()),v(Object(u.o)(e)),p(!1),o(O.d.Home)};Object(a.useEffect)((()=>{if(c){const e=new MutationObserver((t=>{const l=document.getElementById("current-mile-portal");l&&""!==l.innerHTML.trim()&&(_(!0),e.disconnect())}));return e.observe(document.body,{childList:!0,subtree:!0}),()=>e.disconnect()}}),[c]);let q=Object(r.jsx)(le,{setStep:o}),z=Object($.translateWithI18Next)(L);if(i===O.d.Home){var Y,Z;const e=(null===U||void 0===U||null===(Y=U.stage)||void 0===Y||null===(Z=Y.code)||void 0===Z?void 0:Z.toLowerCase())||O.c.REGULAR.toLowerCase();z=Object($.translateWithI18Next)(E),q=c?Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)(D.a,{className:"rounded-8 mileage-loyalty-status ".concat(e),style:{backgroundColor:null===H||void 0===H?void 0:H[e]},children:[Object(r.jsxs)(w.a,{md:"5",xs:"12",className:"membership-right-section rounded-8",children:[null!==m&&void 0!==m&&m.MilesMemberId?Object(r.jsxs)("div",{className:"membership-id-container d-flex justify-content-center",children:[Object($.translateWithI18Next)(P)," ",Object(r.jsx)("span",{className:"membership-id-value",children:null===m||void 0===m?void 0:m.MilesMemberId})]}):Object(r.jsx)(oe,{classes:"w-80 mb-1"}),!f&&Object(r.jsx)(oe,{classes:"w-60"}),Object(r.jsx)("div",{id:"current-mile-portal",className:"text-center"}),Object(r.jsx)(N,{qrSize:160})]}),Object(r.jsx)(w.a,{md:"7",xs:"12",className:"loyalty-status-container d-flex justify-content-center align-items-center pr-0",children:Object(r.jsx)(A,{setStep:o,isNewVersionStyle:c})})]}),Object(r.jsx)(se.a,{header:Object(r.jsx)(re,{}),children:Object(r.jsx)(B,{isNewVersionStyle:c})}),Object(r.jsx)(w.a,{xs:"12",className:"p-0",children:Object(r.jsx)(S,{setStep:o,setCartType:b,setShowConfirmationModal:p,handleUnlinkedAction:V,showConfirmationModal:I})})]}):Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)(w.a,{lg:"5",xs:"12",className:"mb-lg-0 mb-4 mileage-loyalty-status ".concat(e),children:[Object(r.jsx)("div",{className:"membership-id d-flex justify-content-center text-white",children:null===m||void 0===m?void 0:m.MilesMemberId}),Object(r.jsx)(N,{}),Object(r.jsx)(A,{setStep:o})]}),Object(r.jsx)(w.a,{lg:"7",xs:"12",className:"p-0",children:Object(r.jsx)(S,{setStep:o,setCartType:b,setShowConfirmationModal:p,handleUnlinkedAction:V,showConfirmationModal:I})})]})}else if(i===O.d.MILE_DETAILS)z=Object($.translateWithI18Next)(E),q=Object(r.jsx)(G,{setStep:o});else if(i===O.d.RANKING){var X,J;z=Object($.translateWithI18Next)(E);const e=(null===U||void 0===U||null===(X=U.stage)||void 0===X||null===(J=X.code)||void 0===J?void 0:J.toLowerCase())||O.c.REGULAR.toLowerCase();q=Object(r.jsx)(ee,{setStep:o,stageColor:e})}else i===O.d.CARD_DETAILS_VIEW&&(j===O.a.KFC?z=Object($.translateWithI18Next)(M):j===O.a.PONTA?z=Object($.translateWithI18Next)(W):j===O.a.RAKUTEN&&(z=Object($.translateWithI18Next)(K)),q=Object(r.jsx)(w.a,{lg:"9",xs:"12",children:Object(r.jsx)(ae.a,{setStep:o,cardType:j,setShowConfirmationModal:p,handleUnlinkedAction:V,showConfirmationModal:I})}));return Object(r.jsxs)("div",{className:"chicken-mile container ".concat(c?"chicken-mile-v2 position-relative":""),children:[n&&s?Object(r.jsxs)("div",{className:"my-page-title",children:[" ",s]}):Object(r.jsx)(r.Fragment,{}),(null===C||void 0===C?void 0:C.message)&&Object(r.jsx)(ce.a,{success:null===C||void 0===C?void 0:C.success,msg:null===C||void 0===C?void 0:C.message}),T&&i===O.d.Home&&Object(r.jsx)("div",{className:"overlay-Loader"}),Object(r.jsxs)(D.a,{className:"chiken-mile-wrapper",children:[l&&i===O.d.Home?Object(r.jsx)(r.Fragment,{}):Object(r.jsxs)(w.a,{lg:"11",xs:"12",className:"d-flex justify-content-center justify-content-lg-between my-5 chicken-mile_heading pl-0",children:[Object(r.jsx)("h4",{className:"chicken-mile_heading4",children:z}),i!==O.d.Home&&Object(r.jsxs)("button",{onClick:()=>o(O.d.Home),className:"d-none d-lg-flex show-qr-btn",children:[Object($.translateWithI18Next)(R)," ",Object(r.jsx)("img",{className:"back-CTA-Arrow",src:k.a.CTA_Arrow,alt:"back-btn"})]})]}),Object(r.jsx)(w.a,{lg:"12",xs:"12",className:"justify-content-lg-center px-lg-0 ".concat(i!==O.d.Home&&i!==O.d.MILE_DETAILS&&i!==O.d.RANKING?"sub-chicken-mile-view":""," ").concat(c?"sub-chiken-mile-view-v2":"d-lg-flex"),children:q})]})]})};de.defaultProps={hideTitle:!1,isNewVersionStyle:!1};t.a=de}}]);