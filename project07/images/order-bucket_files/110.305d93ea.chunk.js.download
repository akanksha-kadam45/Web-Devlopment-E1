(this["webpackJsonpreusable-comps"]=this["webpackJsonpreusable-comps"]||[]).push([[110],{1068:function(e,t,o){"use strict";o.r(t);var i=o(3),l=o(28),s=o(62),n=o(6),a=o(15),c=o(46),r=o(190),d=o(49);const u={orderId:"",phoneNumber:"",total:"",enteredOtpValue:"",invalidOtpCount:1,disabledOtpLink:!1,enableSubmitBtn:!1,submissionError:"",isOtpMatch:!0,otpSendTo:"",isItPageView:!0,expectedOTPLength:6,showResendButton:!1,tenantId:"",otpValidated:"",collectionPoint:null,instruction:"",checkInSummary:""};var v=o(5),b=o(1273),p=o(26),O=o(2);var j=e=>{var t,o,j,h;const{location:m}=e,{Stripelarge:E,Error:x}=a.a,{SENT_AN_SMS:I,CODE_INVALID:N}=r.e,{TRUE_MONEY_WALLET_CONSTANTS:T}=p.a,f=Object(s.g)(),S=Object(l.b)(),[g,D]=Object(i.useState)(u),k=Object(l.c)((e=>e.tenantReducer||null)),{payment:{otpInputCountTruemoneyWallet:C=6,otpTimerValueTruemoneyWallet:y=179,otpMaxAttemptTruemoneyWallet:w=3}={}}=null!==(t=null===k||void 0===k||null===(o=k.componentOptions)||void 0===o?void 0:o.web)&&void 0!==t?t:{},{checkout:{numberOfDigitsTobeMasked:_,maskedNumberOfDigit:M}={}}=null!==(j=null===k||void 0===k?void 0:k.componentOptions)&&void 0!==j?j:{},A=Object(i.useCallback)((e=>{g&&D((t=>({...t,...e})))}),[]);Object(i.useEffect)((()=>{(null===m||void 0===m||!m.key)&&Object(v.Ye)({history:f})}),[null===m||void 0===m?void 0:m.key]),Object(i.useEffect)((()=>{var e;null!==f&&void 0!==f&&null!==(e=f.location)&&void 0!==e&&e.props||Object(v.Se)({history:f},!1,!1,!1,!1,!0)}),[null===f||void 0===f||null===(h=f.location)||void 0===h?void 0:h.props]),Object(i.useEffect)((()=>{null!==g&&void 0!==g&&g.submissionError&&((null===g||void 0===g?void 0:g.submissionError)===(null===T||void 0===T?void 0:T.OTP_INVALID)?A({isOtpMatch:!1}):(null===g||void 0===g?void 0:g.submissionError)===(null===T||void 0===T?void 0:T.INSUFFICIENT_BALANCE)||(null===g||void 0===g?void 0:g.submissionError)===(null===T||void 0===T?void 0:T.ERROR_TRANSACTION_CALL)?Object(v.cf)({history:f}):Object(v.Se)({history:f},!1,!1,!1,!0))}),[null===g||void 0===g?void 0:g.submissionError]),Object(i.useEffect)((()=>{(null===g||void 0===g?void 0:g.otpValidated)&&Object(v.cf)(e)}),[null===g||void 0===g?void 0:g.otpValidated]),Object(i.useEffect)((()=>{var e,t,o,i,l,s,n,a,c,r,d,u,v,b,p;(null===m||void 0===m?void 0:m.props)&&A({total:null===m||void 0===m||null===(e=m.props)||void 0===e||null===(t=e.checkoutDetails)||void 0===t?void 0:t.total,orderId:null===m||void 0===m||null===(o=m.props)||void 0===o||null===(i=o.checkoutDetails)||void 0===i?void 0:i.orderId,otpSendTo:null===m||void 0===m||null===(l=m.props)||void 0===l||null===(s=l.checkoutDetails)||void 0===s||null===(n=s.validPhoneNumber)||void 0===n?void 0:n.mobileNumber,tenantId:null===m||void 0===m||null===(a=m.props)||void 0===a||null===(c=a.checkoutDetails)||void 0===c?void 0:c.tenantId,collectionPoint:null===m||void 0===m||null===(r=m.props)||void 0===r||null===(d=r.checkoutDetails)||void 0===d?void 0:d.collectionPoint,instruction:null===m||void 0===m||null===(u=m.props)||void 0===u||null===(v=u.checkoutDetails)||void 0===v?void 0:v.instruction,checkInSummary:null===m||void 0===m||null===(b=m.props)||void 0===b||null===(p=b.checkoutDetails)||void 0===p?void 0:p.checkInSummary,dispatch:S})}),[m]);return Object(O.jsx)(O.Fragment,{children:Object(O.jsxs)("div",{class:"mobileOtp",children:[Object(O.jsxs)("div",{class:"row title kfcStripes",children:[Object(O.jsx)(c.a,{srcFile:E,alt:"kfc",className:"stripes"}),Object(O.jsx)("h1",{children:Object(n.translateWithI18Next)(I)})]}),!(null!==g&&void 0!==g&&g.isOtpMatch)&&Object(O.jsxs)("div",{class:"error-div-container",children:[Object(O.jsx)(c.a,{srcFile:x,alt:"kfc",className:'error-icon"'}),Object(O.jsx)("span",{class:"error-div-msg",children:Object(n.translateWithI18Next)(N)})]}),Object(O.jsx)(b.a,{otpSendTo:null===g||void 0===g?void 0:g.otpSendTo,callValidateOtpAPI:e=>{(e=>{var t;const{getSubmissionDetails:o,updateSubmissionDetails:i,otpValue:l}=e;null===o||void 0===o||o.dispatch(Object(d.B)({tenantId:null===o||void 0===o?void 0:o.tenantId,data:{OrderId:null===o||void 0===o?void 0:o.orderId,Amount:null===o||void 0===o||null===(t=o.total)||void 0===t?void 0:t.toString(),OtpCode:l}},(e=>{i({otpValidated:!0})}),(e=>{i({submissionError:e})})))})({otpValue:e,getSubmissionDetails:g,updateSubmissionDetails:A})},isOtpMatch:null===g||void 0===g?void 0:g.isOtpMatch,hideError:()=>{A({isOtpMatch:!0,submissionError:""})},invalidOtpCount:null===g||void 0===g?void 0:g.invalidOtpCount,isItPageView:null===g||void 0===g?void 0:g.isItPageView,showResendButton:null===g||void 0===g?void 0:g.showResendButton,collectionPoint:null===g||void 0===g?void 0:g.collectionPoint,instruction:null===g||void 0===g?void 0:g.instruction,checkInSummary:null===g||void 0===g?void 0:g.checkInSummary,otpInputCountTruemoneyWallet:C,otpTimerValueTruemoneyWallet:y,showInvalidAttempt:!1,numberOfDigitsTobeMasked:_,maskedNumberOfDigit:M})]})})};t.default=j},1273:function(e,t,o){"use strict";var i=o(3),l=o.n(i),s=(o(75),o(6)),n=o(41),a=o(15),c=o(190),r=o(144),d=o(62),u=o(4),v=o(5),b=(o(0),o(2));var p=e=>{let{timeSrc:t,resendOtpHandler:o,disabledOtpLink:l,fromCheckout:n,updateCheckoutDetails:a,showGuidanceMessageForOtpExpiry:r,showResendButton:p=!0}=e;const[O,j]=Object(i.useState)(t),[h,m]=Object(i.useState)(0),[E,x]=Object(i.useState)(0),I=Object(d.g)(),N=e=>{const t=Math.floor(e/60),o=e-60*t;m(t),x(o),j((e=>e-1))};Object(i.useEffect)((()=>{N(t)}),[t]),Object(i.useEffect)((()=>{let e;return O>=0?e=setInterval((()=>{N(O)}),1e3):clearInterval(e),()=>{e&&clearInterval(e)}}),[O]);return Object(b.jsxs)(b.Fragment,{children:[(O>=0&&n&&r&&a({showGuidanceMessageForOtpExpiry:!1}),O>=0?n?Object(b.jsxs)("span",{children:["".concat(Object(s.translateWithI18Next)(null===c.e||void 0===c.e?void 0:c.e.TIMER_EXPIRED_TEXT))," ",h,":",E<10&&"0".concat(E)||E]}):Object(b.jsxs)("span",{children:["".concat(Object(s.translateWithI18Next)(null===u.a||void 0===u.a?void 0:u.a.TIMER_EXPIRED_TEXT_ACCOUNT))," ",h,":",E<10&&"0".concat(E)||E," ",Object(s.translateWithI18Next)(null===u.a||void 0===u.a?void 0:u.a.SECONDS)]}):p?((e,t,o)=>(t&&!o&&e({showGuidanceMessageForOtpExpiry:!0}),Object(s.translateWithI18Next)(c.e.CODE_TIMER_EXPIRED)))(a,n,r):Object(v.Se)({history:I},!1,!1,!0,!1)),p&&Object(b.jsx)("div",{children:Object(b.jsx)("button",{"data-testid":"resend-otp-testid",disabled:l,className:"otp-link-button ".concat(l?"disableOtpLinkCls":""),id:"otpResendButton",onClick:e=>{j(179),o(e)},children:Object(s.translateWithI18Next)(c.e.RESEND_CODE)})})]})},O=o(28),j=o(97);const h=e=>document.getElementById("codeBox"+e),m=e=>Object.fromEntries(Array.from({length:e},((e,t)=>[t,""]))),E=e=>{var t,o;const{closeOtpModalHandler:l,otpSendTo:d,fromCheckout:u,callValidateOtpAPI:v,callResendOtpAPI:E,isOtpMatch:x,hideError:I,invalidOtpCount:N,isItPageView:T=!1,showResendButton:f=!0,otpInputCountTruemoneyWallet:S="",otpTimerValueTruemoneyWallet:g="",updateCheckoutDetails:D,closeOtpModalHandlerCheckout:k,numberOfDigitsTobeMasked:C,maskedNumberOfDigit:y,checkoutDetails:w,showInvalidAttempt:_=!0}=e,M=Object(O.c)((e=>e.tenantReducer)),{otpInputLength:A,otpTimerValue:P}=(null===M||void 0===M||null===(t=M.componentOptions)||void 0===t||null===(o=t.web)||void 0===o?void 0:o.accountPage)||{},{SUBMIT_BUTTON_TEXT:R,SENT_AN_SMS:W,OTP_SENT_TEXT:F,INVALID_OTP:V,USE_A_DIFFERENT_NUMBER:B,INVALID_CODE:L,PAYMENT_TAKEN:X,PAYMENT_SUBMITTED:U,PASSCODE:G}=c.e,[H,Y]=Object(i.useState)(!1),[K,J]=Object(i.useState)(!1),z=S||A,[$]=Object(i.useState)(g||P);let q=m(T?S:A);const[Q,Z]=Object(i.useState)(q),[ee,te]=Object(i.useState)(q),[oe,ie]=Object(i.useState)($);Object(i.useEffect)((()=>{let e=Object.values(ee).join("").length;z===e?J(!0):(J(!1),u?I(D):I())}),[ee]),Object(i.useEffect)((()=>{u&&!x&&0!==N&&(J(!1),I(D))}),[u,x,N]);const le={closeDataTestId:"close-otp-testId",role:"dialog",show:!1,classNames:"customized-otp-modal",showCloseBtn:!0,closeButtonHandler:u?()=>((e,t)=>{k(e,t)})(w,D):l,modalTitle:Object(s.translateWithI18Next)(W)};Object(i.useEffect)((()=>{const e=setInterval((()=>{ie((e=>e>0?e-1:e))}),1e3);return()=>clearInterval(e)}),[oe]);const se=Object(b.jsxs)(b.Fragment,{children:[u&&!x&&0!==N&&Object(b.jsxs)("div",{className:"otp-error-text otp-attempt-error-show",children:[Object(b.jsx)("span",{children:Object(b.jsx)("img",{src:a.a.Error,alt:"Error visible"})}),Object(s.translateWithI18Next)(L),_&&"(".concat(N,"/3)")]}),u&&(null===w||void 0===w?void 0:w.showGuidanceMessageForOtpExpiry)&&Object(b.jsxs)("div",{className:"otp-error-text otp-attempt-error-show",children:[Object(b.jsx)("span",{children:Object(b.jsx)("img",{src:a.a.Error,alt:"Error visible"})}),Object(s.translateWithI18Next)(c.e.VERIFICATION_CODE_EXPIRED)]}),Object(b.jsxs)("div",{className:"otp-main-container ".concat(T&&"page-otp-main-container"," "),children:[Object(b.jsxs)("div",{className:"left-section",children:[" ",Object(b.jsx)("div",{children:Object(s.translateWithI18Next)(W)})]}),Object(b.jsxs)("div",{className:"right-section",children:[Object(b.jsxs)("div",{className:"otp-title-text otp-title-text-th",children:[Object(s.translateWithI18Next)(F),"."]}),Object(b.jsx)("div",{className:"sendto",children:(ne=d,null===ne||void 0===ne?void 0:ne.replace(ne.substring(0,C),y))}),u&&Object(b.jsx)("button",{className:"useDifferentNumberButton",onClick:()=>(e=>{e({useDifferentNumberFlow:!0,openOtpModal:!1,useDifferentNumberFlowFlagForGuidanceMessage:!0}),Object(j.o)(w,e)})(D),children:Object(s.translateWithI18Next)(B)}),Object(b.jsxs)("div",{className:"otpDiv","aria-describedby":"otpInvalid",children:[[...Array(z)].map(((e,t)=>Object(b.jsx)("input",{id:"codeBox".concat(t),"data-testid":"otp-testid-".concat(t),className:"otpNum ".concat(x||0===N?"":"otpNum-invalid"),type:"tel",maxLength:1,onKeyPress:e=>(e=>{(8!==e.which&&0!==e.which&&e.which<48||e.which>57)&&e.preventDefault()})(e),onKeyUp:e=>((e,t,o)=>{var i,l;const s=e.which||e.keyCode;if(1===(null===(i=h(t))||void 0===i||null===(l=i.value)||void 0===l?void 0:l.length))if(t!==o-1){const e=h(t+1);e&&e.focus()}else h(t).blur();8===s&&0!==t&&h(t-1).focus()})(e,t),onChange:e=>((e,t)=>{let o=e.target.value;Z((e=>({...e,[t]:o}))),te((e=>({...e,[t]:o})))})(e,t),onBlur:()=>(e=>{Z((t=>({...t,[e]:null===ee||void 0===ee?void 0:ee[e]})))})(t),onFocus:()=>(e=>{Z((t=>({...t,[e]:""}))),te((t=>({...t,[e]:""})))})(t),value:null===Q||void 0===Q?void 0:Q[t],onInput:e=>(e=>{const t=e.target.value;/^\d*$/.test(t)||(e.target.value=t.slice(0,-1))})(e)},"key".concat(t)))),!x&&0!==N&&!Object.values(Q).every((e=>""===e))&&Object(b.jsx)("img",{"data-testid":"clear-otp-testid",className:"",src:a.a.Clear_icon,alt:"clear otp",onClick:()=>{Z((()=>q)),te((()=>q))}})]}),u&&(null===w||void 0===w?void 0:w.showGuidanceMessageForOtpExpiry)&&Object(b.jsxs)("div",{className:"otp-error-text dob-error-show otp-invalid",children:[Object(b.jsx)("span",{children:Object(b.jsx)("img",{src:a.a.Error,alt:"Error visible"})}),Object(s.translateWithI18Next)(c.e.CODE_EXPIRED_TEXT)]}),!x&&0!==N&&Object(b.jsxs)("div",{className:"otp-error-text dob-error-show otp-invalid",children:[Object(b.jsx)("span",{children:Object(b.jsx)("img",{src:a.a.Error,alt:"Error visible"})}),Object(s.translateWithI18Next)(V)," ",_&&"(".concat(N,"/3)")]}),T&&Object(b.jsx)("div",{className:"infoPayment",children:Object(b.jsx)("p",{children:Object(s.translateWithI18Next)(X)})}),Object(b.jsx)("div",{className:"otp-expired-text",children:Object(b.jsx)(p,{timeSrc:$,resendOtpHandler:e=>{e.preventDefault(),ie($),E(w),Y(!0),setTimeout((()=>{Y(!1)}),3e4)},disabledOtpLink:H,fromCheckout:u,updateCheckoutDetails:D,showGuidanceMessageForOtpExpiry:null===w||void 0===w?void 0:w.showGuidanceMessageForOtpExpiry,showResendButton:f})}),Object(b.jsx)("div",{className:"buttons-container",children:Object(b.jsx)(n.a,{className:"buttons-group ".concat(K&&0!==oe?"save":"save-disabled"),"data-testid":"update-account-button-testid",onClickHandler:()=>(()=>{let e=Object.values(ee).join("");v(e),J(!1)})(),disabled:!K||0===oe,children:Object(s.translateWithI18Next)(R)})})]})]})]});var ne;return T?se:Object(b.jsx)(r.a,{...le,children:se})};t.a=l.a.memo(E)}}]);