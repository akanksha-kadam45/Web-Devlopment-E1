(this["webpackJsonpreusable-comps"]=this["webpackJsonpreusable-comps"]||[]).push([[119],{1061:function(e,d,a){"use strict";a.r(d);var t=a(3),l=a(28),n=a(62),o=a(49),i=a(0),s=a(6),c=a(4),r=a(372),v=a(14),u=a(11),m=a(5),b=a(77),p=a(26),O=a(2);const{GLOBAL_PAYMENTS_CONSTANTS:j}=p.a;var h=e=>{var d,a,l;const{paymentDetails:o,updateSaveCardDetails:i}=e,p=Object(n.g)(),h={checkoutDetails:o,updateCheckoutDetails:i,history:p};return Object(t.useEffect)((()=>{i({enablePaymentProviderPlaceOrderBtn:!0,paymentProviderPlaceOrderBtn:b.h}),Object(m.xe)(Object(v.a)(u.U),null===j||void 0===j?void 0:j.GLOBAL_PAYMENTS_SCRIPT_ID)}),[]),Object(t.useEffect)((()=>{Object(b.c)(o,i,h)}),[null===o||void 0===o?void 0:o.tenantId,null===o||void 0===o?void 0:o.appchannel]),Object(O.jsxs)(O.Fragment,{children:[(null===(d=window)||void 0===d?void 0:d.GlobalPayments)&&(null===o||void 0===o?void 0:o.globalPaymentsAccesstoken)&&Object(O.jsx)(r.a,{...h,fromAccountpage:!0}),Object(O.jsxs)("div",{className:"row globalpayment-add-new-card",children:[Object(O.jsx)("div",{className:"col-sm-4 col-12",children:Object(O.jsxs)("div",{id:"add-new-card-cont",children:[Object(O.jsx)("div",{id:"payment-place-order-cont",children:Object(b.h)(h)}),Object(O.jsx)("div",{id:"payment-provider-place-order-form",className:"".concat(null!==o&&void 0!==o&&null!==(a=o.paymentCardDetails)&&void 0!==a&&a.isFormValid&&null!==o&&void 0!==o&&null!==(l=o.billingAddressAndSaveCard)&&void 0!==l&&l.isBillingAddressFormDetailsValid?"":"addCardInValid")})]})}),Object(O.jsx)("div",{className:"col-sm-4 col-12",children:Object(O.jsx)("div",{className:"add-cancel-button",children:Object(O.jsx)("div",{className:"mt-10 button font-bold whiteButton blackBorder","data-testid":"add-cancel-button",onClick:()=>N(p),children:Object(s.translateWithI18Next)(null===c.a||void 0===c.a?void 0:c.a.CANCEL)})})})]})]})};const C={isAddNewCard:!0,paymentProvider:"",paymentCardDetails:{cardNumber:"",cardExpDate:"",cardCVV:"",cardHolderName:"",deliveryAddressCheck:!0,saveCardCheck:!1,nickName:"",isFormValid:!1},tenantId:"",tender:{name:"credit-card",payload:{}},globalPaymentsAccesstoken:"",globalPaymentsOneTimeResponse:"",globalPaymentValidateAdressResponse:"",globalPaymentSaveCard:"",saveCardCheck:!1,savedCards:[],customerId:"",firstName:"",lastName:"",countryCodeNumeric:"",billingAddressAndSaveCard:{Showcheckbox:!1,addressLine:"",fulladdress:"",city:"",pincode:"",state:"",issavecard:!1,nickName:"",isvalid:!1,defaultAddressSelected:!1,enabledSaveCard:!1,isBillingAddressFormDetailsValid:!1,country:""},allowedTenders:[],showCardNickNameError:!1},y=e=>{var d;return(null===e||void 0===e||null===(d=e.paymentDetails)||void 0===d?void 0:d.paymentProvider)===i.Td.GLOBAL_PAYMENTS?Object(O.jsx)(h,{...e}):Object(O.jsx)(O.Fragment,{})},N=e=>{Object(m.Id)(window.location)?window.ReactNativeWebView.postMessage(JSON.stringify({cancel:"cancel"})):null===e||void 0===e||e.push({pathname:"/account",selectOption:null===c.a||void 0===c.a?void 0:c.a.MY_PAYMENT_METHODS})};var g=a(15),w=a(46),f=a(132),A=a(331),x=a(328),S=a(85),P=a(52);var I=e=>{var d,a;const[r,v]=Object(t.useState)(C),{tenantReducer:u,profileReducer:b,paymentsContentReducer:p,appStateReducer:j}=Object(l.c)((e=>e)),{userOrderStateDispatch:h}=Object(t.useContext)(S.a),I=Object(t.useCallback)((e=>{v&&v((d=>({...d,...e})))}),[]),k=Object(l.b)(),E=Object(f.a)(),D=Object(n.g)();return Object(t.useEffect)((()=>{var e,d,a;(null===b||void 0===b?void 0:b.customerId)&&I({savedCards:null!==(e=null===b||void 0===b?void 0:b.savedCards)&&void 0!==e?e:[],customerId:null===b||void 0===b?void 0:b.customerId,firstName:null===b||void 0===b||null===(d=b.basic)||void 0===d?void 0:d.firstName,lastName:null===b||void 0===b||null===(a=b.basic)||void 0===a?void 0:a.lastName})}),[null===b||void 0===b?void 0:b.customerId]),Object(t.useEffect)((()=>{var e,d,a,t,l,n,o,i,s,c,r,v;(null===u||void 0===u||null===(e=u.componentOptions)||void 0===e||null===(d=e.payment)||void 0===d?void 0:d.paymentProvider)&&I({tenantId:null===u||void 0===u?void 0:u.tenantId,paymentProvider:null===u||void 0===u||null===(a=u.componentOptions)||void 0===a||null===(t=a.payment)||void 0===t?void 0:t.paymentProvider,countryCodeNumeric:null===u||void 0===u?void 0:u.countryCodeNumeric,nameOnCardRegex:null===u||void 0===u||null===(l=u.componentOptions)||void 0===l||null===(n=l.checkout)||void 0===n?void 0:n.nameOnCardRegex,postalCodeRegex:null===u||void 0===u||null===(o=u.componentOptions)||void 0===o||null===(i=o.web)||void 0===i||null===(s=i.global)||void 0===s?void 0:s.postalCodeRegex,billingAddressLength:null===u||void 0===u||null===(c=u.componentOptions)||void 0===c||null===(r=c.web)||void 0===r||null===(v=r.global)||void 0===v?void 0:v.billingAddressLength})}),[null===u||void 0===u||null===(d=u.componentOptions)||void 0===d||null===(a=d.payment)||void 0===a?void 0:a.paymentProvider]),Object(t.useEffect)((()=>{(null===p||void 0===p?void 0:p.tendersContent)&&I({tendersContent:null===p||void 0===p?void 0:p.tendersContent,userOrderStateDispatch:h})}),[null===p||void 0===p?void 0:p.tendersContent]),Object(t.useEffect)((()=>{null===k||void 0===k||k(Object(A.b)()),k&&I({dispatch:k,history:D,sliceDispatch:E}),null===k||void 0===k||k(Object(o.z)())}),[k]),Object(t.useEffect)((()=>{var e,d,a;const t=new URLSearchParams(null===(e=window)||void 0===e||null===(d=e.location)||void 0===d?void 0:d.search).get(i.De),l=JSON.parse(decodeURIComponent(t));(null===m.Id||void 0===m.Id?void 0:Object(m.Id)(null===(a=window)||void 0===a?void 0:a.location))&&I({savedCards:null!==l&&void 0!==l?l:[]})}),[]),Object(t.useEffect)((()=>{var e;return(null===m.Id||void 0===m.Id?void 0:Object(m.Id)(null===(e=window)||void 0===e?void 0:e.location))&&k(Object(x.o)()),()=>{h({type:null===P.a||void 0===P.a?void 0:P.a.SHOW_BUCKET_LOADER,value:!1}),I({showPlaceOrderLoading:!1})}}),[]),Object(t.useEffect)((()=>{(null===j||void 0===j?void 0:j.userStatus)&&I({userParams:null===j||void 0===j?void 0:j.userStatus})}),[null===j||void 0===j?void 0:j.userStatus]),Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)("div",{className:"my-payment-methods-header-mobile",children:[Object(O.jsx)(w.a,{srcFile:g.a.SingleArrowback,className:"backArrow-account-setting","data-testid":"backArrow-account-setting",onClick:()=>N(D)}),Object(O.jsxs)("span",{className:"payment-methods-heading-headertext",children:[" ",Object(s.translateWithI18Next)(null===c.a||void 0===c.a?void 0:c.a.MY_PAYMENT_METHODS)]})]}),Object(O.jsx)("div",{className:"add-newcard-conatiner",children:y({paymentDetails:r,updateSaveCardDetails:I})})]})};d.default=I}}]);