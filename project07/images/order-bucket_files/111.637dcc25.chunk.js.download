(this["webpackJsonpreusable-comps"]=this["webpackJsonpreusable-comps"]||[]).push([[111],{1067:function(e,l,i){"use strict";i.r(l);var d=i(3),o=i.n(d),t=i(28),n=i(85),a=i(1310),v=i(2);const u=e=>{const{paymentDetails:l,updatePaymentDetails:i}=e;return Object(v.jsx)(v.Fragment,{children:(null===l||void 0===l?void 0:l.tenantId)&&(null===l||void 0===l?void 0:l.basketId)&&(null===l||void 0===l?void 0:l.customerId)&&(null===l||void 0===l?void 0:l.allowedTenders)&&Object(v.jsx)(a.a,{...e,checkoutDetails:l,updateCheckoutDetails:i})})};var r=o.a.memo(u),c=i(97),s=i(328),O=i(5);var b=e=>{const l=Object(t.b)(),[i,o]=Object(d.useState)(c.c),{userOrderStateDispatch:a}=Object(d.useContext)(n.a),u=Object(d.useCallback)((e=>{o&&o((l=>({...l,...e})))}),[]),{paymentsContentReducer:b,tenantReducer:m}=Object(t.c)((e=>e));return Object(d.useEffect)((()=>{Object(c.F)(b,u)}),[null===b||void 0===b?void 0:b.tendersContent]),Object(d.useEffect)((()=>{var e,i,d,o,t,n,v;const r=new URLSearchParams(window.location.search),c=r.get("token"),s=r.get("gpData"),b=JSON.parse(decodeURIComponent(s)),P={...b,RNAtoken:c,nameOnCardRegex:new RegExp(null===b||void 0===b?void 0:b.nameOnCardRegex),postalCodeRegex:null===m||void 0===m||null===(e=m.componentOptions)||void 0===e||null===(i=e.web)||void 0===i||null===(d=i.global)||void 0===d?void 0:d.postalCodeRegex,paymentTypeSelectedForLastUsedPayment:null===m||void 0===m||null===(o=m.componentOptions)||void 0===o||null===(t=o.checkout)||void 0===t?void 0:t.paymentTypeSelectedForLastUsedPayment};u({dispatch:l,userOrderStateDispatch:a,isRenderFromRNA:null===O.Id||void 0===O.Id?void 0:Object(O.Id)(null===(n=window)||void 0===n?void 0:n.location),paymentEnabled:null===O.Id||void 0===O.Id?void 0:Object(O.Id)(null===(v=window)||void 0===v?void 0:v.location),...P})}),[l]),Object(d.useEffect)((()=>{(null===i||void 0===i?void 0:i.tenantId)&&l(Object(s.o)())}),[null===i||void 0===i?void 0:i.tenantId]),Object(v.jsx)(r,{...e,paymentDetails:i,updatePaymentDetails:u})};l.default=b},1310:function(e,l,i){"use strict";var d=i(3),o=i(29),t=i(218),n=i(328),a=i(0),v=i(49),u=i(1156);var r=()=>{const e=Object(u.k)();return{getCartAvailability:Object(d.useCallback)((()=>{e.mutate()}),[e])}},c=i(4),s=i(140),O=i(5),b=i(85),m=i(26),P=i(62),y=i(28);l.a=e=>{var l,i,u,p,j,A,E,f,C,T,h,g;const{checkoutDetails:k,updateCheckoutDetails:N}=e,{dispatch:D,tender:I,isPaymentTypeSelected:R}=k,w=Object(d.useRef)(k),{userOrderState:S}=Object(d.useContext)(b.a),Y=Object(O.Lb)(S),_=Object(P.g)(),{getCartAvailability:x}=r(),M=(null===(l=Object(y.c)((e=>null===e||void 0===e?void 0:e.storesReducer)))||void 0===l||null===(i=l.storesWithStatus[0])||void 0===i||null===(u=i.summary)||void 0===u?void 0:u.deliveryPartner)||"";return Object(d.useEffect)((()=>{var e,l,i;let d={paymentPanelTitle:null===c.a||void 0===c.a?void 0:c.a.ADD_PAYMENT_METHOD_HEADER};switch(null===k||void 0===k?void 0:k.paymentProvider){case a.Td.GLOBAL_PAYMENTS:d={enablePayOnArrival:!0,payOnArrivalAllowedTenders:null===k||void 0===k||null===(e=k.allowedTenders)||void 0===e?void 0:e.filter((e=>e===a.Vd.PAY_BY_CASH)),payNowAllowedTenders:null===k||void 0===k||null===(l=k.allowedTenders)||void 0===l?void 0:l.filter((e=>e!==a.Vd.PAY_BY_CASH)),paymentPanelTitle:null===c.a||void 0===c.a?void 0:c.a.PAYMENT_BY};break;case a.Td.PAY_GATE:case null===a.Td||void 0===a.Td?void 0:a.Td.JAPAN_PAYMENTS:case null===a.Td||void 0===a.Td?void 0:a.Td.THAILAND_PAYMENTS:d={paymentPanelTitle:null===c.a||void 0===c.a?void 0:c.a.PAYMENT_BY};break;case a.Td.ADYEN_PAYMENTS:d={paymentPanelTitle:null===m.a||void 0===m.a||null===(i=m.a.ADYEN_PAYMENT_TYPE)||void 0===i?void 0:i.PAYMENT_OPTIONS}}N(d)}),[]),Object(d.useEffect)((()=>{D&&(null===D||void 0===D||D(null===n.o||void 0===n.o?void 0:Object(n.o)()))}),[D]),Object(d.useEffect)((()=>{w.current=k}),[R,null===I||void 0===I?void 0:I.name,null===I||void 0===I?void 0:I.payload]),Object(d.useEffect)((()=>{Object(O.le)()&&Object(o.q)(k,N),D&&D(Object(v.z)())}),[null===k||void 0===k?void 0:k.paymentEnabled]),Object(d.useEffect)((()=>{var e;(null===k||void 0===k||null===(e=k.tender)||void 0===e?void 0:e.name)&&Object(o.u)(k)}),[null===k||void 0===k||null===(p=k.tender)||void 0===p?void 0:p.name]),Object(d.useEffect)((()=>{var e;(null===k||void 0===k||null===(e=k.userParams)||void 0===e?void 0:e.loggedIn)&&Object(o.z)(k,N)}),[null===k||void 0===k||null===(j=k.userFullName)||void 0===j?void 0:j.value,null===k||void 0===k||null===(A=k.userEmail)||void 0===A?void 0:A.value,null===k||void 0===k||null===(E=k.userPhone)||void 0===E?void 0:E.value]),Object(d.useEffect)((()=>{var l;if(null!==k&&void 0!==k&&k.enablePayOnArrival&&null!==k&&void 0!==k&&k.enablePayByCashOption&&(null===e||void 0===e||null===(l=e.location)||void 0===l||!l.isRetryPaymentErrorEnabled)){const e=Object(o.j)(k,N);N({isClickPayOnArrival:e})}}),[null===k||void 0===k?void 0:k.enablePayOnArrival,null===k||void 0===k?void 0:k.userOption]),Object(d.useEffect)((()=>{null!==k&&void 0!==k&&k.enablePayOnArrival&&null!==k&&void 0!==k&&k.enablePayByCashOption&&(Object(o.i)(k,N),N({isClickAddPayment:null===k||void 0===k?void 0:k.isClickPayOnArrival,isPaymentTypeSelected:null===k||void 0===k?void 0:k.isClickPayOnArrival}))}),[null===k||void 0===k?void 0:k.isClickPayOnArrival]),Object(d.useEffect)((()=>{0!==(null===k||void 0===k?void 0:k.total)&&null!==k&&void 0!==k&&k.showGiftCardOrVoucher&&N({tender:{name:"",payload:{}},enableContinuePayment:!1,isClickContinuePayment:!0,isClickAddPayment:!1,isPaymentTypeSelected:!0})}),[null===k||void 0===k?void 0:k.total]),Object(d.useEffect)((()=>{0===(null===k||void 0===k?void 0:k.total)&&null!==k&&void 0!==k&&k.isOrderWithoutPayment&&null!==k&&void 0!==k&&k.showGiftCardOrVoucher&&N({enableContinuePayment:!1,isPaymentTypeSelected:!0,showPlaceOrderLoading:!1,isCateringSomeOneElseContactDetailsAreValid:!0,placeOrderButtonEnabled:!0,isClickContinuePayment:!1,tender:{name:a.Vd.WICODE,payload:{name:a.Vd.WICODE,amount:null===k||void 0===k?void 0:k.total},amount:null===k||void 0===k?void 0:k.total}})}),[null===k||void 0===k?void 0:k.isOrderWithoutPayment,null===k||void 0===k?void 0:k.showGiftCardOrVoucher,null===k||void 0===k?void 0:k.total]),Object(d.useEffect)((()=>{(null===k||void 0===k?void 0:k.isOrderWithoutPayment)&&(null===k||void 0===k?void 0:k.orderId)&&(null===k||void 0===k?void 0:k.isCreateOrderValidateCompleted)&&Object(O.cf)(e)}),[null===k||void 0===k?void 0:k.isCreateOrderValidateCompleted]),Object(d.useEffect)((()=>{(null===k||void 0===k?void 0:k.isRenderFromRNA)&&Object(o.a)(k,N,!1)}),[null===k||void 0===k?void 0:k.isRenderFromRNA]),Object(d.useEffect)((()=>{var e;(null!==(e=k.userParams)&&void 0!==e&&e.loggedIn||null!==k&&void 0!==k&&k.isContactDetailValid)&&N({paymentEnabled:Object(t.b)(k)})}),[null===k||void 0===k||null===(f=k.userParams)||void 0===f?void 0:f.loggedIn,null===k||void 0===k?void 0:k.isContactDetailValid,null===k||void 0===k||null===(C=k.collectionPoint)||void 0===C?void 0:C.name,null===k||void 0===k||null===(T=k.collectionPoint)||void 0===T?void 0:T.carNumber]),Object(d.useEffect)((()=>{var l,i;if(null!==k&&void 0!==k&&null!==(l=k.userParams)&&void 0!==l&&l.loggedIn)switch(null===e||void 0===e||null===(i=e.checkoutDetails)||void 0===i?void 0:i.paymentProvider){case a.Td.BRAIN_TREE:case a.Td.ADYEN_PAYMENTS:return Object(o.y)(k,N,!1);case a.Td.JAPAN_PAYMENTS:return(null===k||void 0===k?void 0:k.total)>0&&Object(s.d)(e)}}),[null===k||void 0===k?void 0:k.paymentProvider,null===k||void 0===k||null===(h=k.userParams)||void 0===h?void 0:h.loggedIn]),Object(d.useEffect)((()=>{var e;(null!==k&&void 0!==k&&k.timerExpired||null!==k&&void 0!==k&&k.maxAttemptReached||null!==k&&void 0!==k&&k.refreshed||null!==k&&void 0!==k&&k.redirectBack)&&((null===k||void 0===k||null===(e=k.userParams)||void 0===e?void 0:e.loggedIn)&&(null===k||void 0===k?void 0:k.lastUsedPaymentMethod)&&N({isClickAddPayment:!0}))}),[null===k||void 0===k?void 0:k.timerExpired,null===k||void 0===k||null===(g=k.userParams)||void 0===g?void 0:g.loggedIn,null===k||void 0===k?void 0:k.maxAttemptReached,null===k||void 0===k?void 0:k.refreshed,null===k||void 0===k?void 0:k.redirectBack]),Object(t.d)({...e,checkoutDetailsUseRef:w,dispositionNew:Y,getCartAvailability:x,history:_,deliveryPartner:M})}}}]);